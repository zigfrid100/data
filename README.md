# Aufgabe 4
_Die vierte Aufgabe besteht darin, dass die Gesch fte (!) über Message-Oriented-Middleware, d.h. MQTT, 
direkt von Erzeugern (Bauernhof, Metzger Importeur und andere Lieferanten) Informationen 
über Sonderangebote erhalten und dann Artikel nachbestellen kann. Dazu generieren die öieferanten 
und Gesch fte periodisch Angebote bzw. Nachfragen für die angebotenen Artikel. Gesch fte konkurrieren 
miteinander wenn gute Angebote erscheinen („First come, first served“); schlechte Angebote ksnnen 
liegen bleiben bzw. vom Anbieter „verbessert“ werden, bis K ufer gefunden werden. Überlegen Sie ganz genau, 
wie Ihrer „virtuelle Markt“ mittels „Publish/Subscribe“-Kan len funktionieren kann und soll 
(wie viele Kan le brauchen Sie? Wer f ngt an, wer wartet auf wen, wie erfahren Kunden, ob sie bzw. 
wie viele sie gekauft haben, usw.)._

----------------------------------------------------------------------------------
######
## For Compile and Start: 

* You need is Maven and Java 8 JDK install.
* Then clone Project on brach step1.

```
$ git clone -b step4 https://github.com/zigfrid100/ds17-18.git
```
* Don't forget change IP-Address by Client 
######

## Compile

The application is written in Java leveraging the Maven build tool. Thus, it is easy to compile the application. All you need is a Java 8 JDK and Maven installed on your system. However, due to the various dependencies within the project, e.g. on code generated by Thrift, the compilation process is slightly more complex and has to follow a certain order. You may compile and package the Thrift application using the following commands:

First compile and package the share library that contains the code generated by Thrift 

```
 $ mvn thrift:compile -am -pl shared
 $ mvn package -am -pl shared
```

Next you can compile the server and the client that depend on the shared library

```
 $ mvn package -am -pl server
 $ mvn package -am -pl client
 $ mvn package -am -pl mqttPublisher
```

The overall build process is automated using a Makefile that then calls the Maven build tools accordingly. The Makefile support the following targets:

* _all_: To compile the whole systems.
* _clean_: To clean up the system and remove all the compiled files.
* _gen-thrift_: To generate the Thrift-generated source code.
* _shared_: To build the shared library package.
* _server_: To build the server.
* _client_: To build the client.

You may call

```
 $ make
``` 

to build the hole system.

Please also note that you have to generate the Thrift-generated source code in order to modify server and client code in an IDE.


## Usage


* Start RPC Server
```
$ cd "Project-Directory"/server/src/main/bash
$ $ ./start-thrift-server.sh 
in Menu 1 for Thrift multi server and 2 for mqtt server
```
* Start RPC MQTT Publisher
```
$ cd "Project-Directory"/mqttPublisher/src/main/bash
$ $ ./mqtt-publisher.sh 
You can start 2 or 3 mqtt clients 
```

* Start UDP Server und UDP Clients
```
$ cd "Project-Directory"/client/src/main/bash
$ ./start-udp-socket-server.sh  
$ ./start-udp-socket-client-sensor.sh "value of clients"
```
* Don't forget chmod u+x "name of bash file"
* Webserver support Google Chrome and Safari.


Aufgabe beschreiben 
Jeder Hersteller(Publisher) lässt in seinem Angebot einen Topicname, für die Nachbestellung.
Wenn die beste Prise gewählt wurde (in ServerHandler ), schickt Geschäft(Zeile 101 in ServerHendler.java) zu Hersteller eine Nachricht.
Jeder Hersteller (mqttPublisher) sendet zu bestimmtem Potic sein Angebot und wartet auf Antwort im einem bestimmtem Topic.
(mqttPublisher -> Main.java gibt es 2 Threads) 